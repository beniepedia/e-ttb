import{r as g,j as s,a as t,b as V,u as ee,d as F,F as te,H as ae,L as re}from"./app.7c053a8b.js";import{P as o,j as T,M as ie,t as P}from"./Main.aaff387b.js";import{C as le,B as j,a as ne,S as se}from"./ButtonIsTaken.43e007dc.js";import{T as oe}from"./TextArea.9b164b82.js";import{B as L}from"./Button.2c4f51ee.js";import{L as E}from"./Label.48693700.js";import{I as $}from"./Input.1a3afc1c.js";import{c as A}from"./Helper.d9e24006.js";import{l as de}from"./lodash.c51f1c27.js";import{a as ce}from"./index.5220e4e6.js";import{d as he,g as H,a as ue,f as U}from"./index.dbcb883f.js";import{r as M,t as y,i as S}from"./index.7f05af33.js";import"./axios.40b98a77.js";var me=["color","size","title"];function pe(e,n){if(e==null)return{};var i=fe(e,n),r,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],!(n.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(i[r]=e[r]))}return i}function fe(e,n){if(e==null)return{};var i={},r=Object.keys(e),a,l;for(l=0;l<r.length;l++)a=r[l],!(n.indexOf(a)>=0)&&(i[a]=e[a]);return i}var D=g.exports.forwardRef(function(e,n){var i=e.color,r=e.size,a=e.title,l=pe(e,me);return s("svg",{ref:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:r,height:r,fill:i,...l,children:[a?t("title",{children:a}):null,t("path",{d:"M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"}),t("path",{fillRule:"evenodd",d:"M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"})]})});D.propTypes={color:o.string,size:o.oneOfType([o.string,o.number]),title:o.string};D.defaultProps={color:"currentColor",size:"1em",title:null};var ge=D,be=["color","size","title"];function ve(e,n){if(e==null)return{};var i=we(e,n),r,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],!(n.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(i[r]=e[r]))}return i}function we(e,n){if(e==null)return{};var i={},r=Object.keys(e),a,l;for(l=0;l<r.length;l++)a=r[l],!(n.indexOf(a)>=0)&&(i[a]=e[a]);return i}var _=g.exports.forwardRef(function(e,n){var i=e.color,r=e.size,a=e.title,l=ve(e,be);return s("svg",{ref:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:r,height:r,fill:i,...l,children:[a?t("title",{children:a}):null,t("path",{fillRule:"evenodd",d:"M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"})]})});_.propTypes={color:o.string,size:o.oneOfType([o.string,o.number]),title:o.string};_.defaultProps={color:"currentColor",size:"1em",title:null};var ye=_,xe=["color","size","title"];function ke(e,n){if(e==null)return{};var i=Ne(e,n),r,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],!(n.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(i[r]=e[r]))}return i}function Ne(e,n){if(e==null)return{};var i={},r=Object.keys(e),a,l;for(l=0;l<r.length;l++)a=r[l],!(n.indexOf(a)>=0)&&(i[a]=e[a]);return i}var C=g.exports.forwardRef(function(e,n){var i=e.color,r=e.size,a=e.title,l=ke(e,xe);return s("svg",{ref:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:r,height:r,fill:i,...l,children:[a?t("title",{children:a}):null,t("path",{d:"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z"}),t("path",{d:"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z"})]})});C.propTypes={color:o.string,size:o.oneOfType([o.string,o.number]),title:o.string};C.defaultProps={color:"currentColor",size:"1em",title:null};var ze=C,Oe=["color","size","title"];function Te(e,n){if(e==null)return{};var i=Pe(e,n),r,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],!(n.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(i[r]=e[r]))}return i}function Pe(e,n){if(e==null)return{};var i={},r=Object.keys(e),a,l;for(l=0;l<r.length;l++)a=r[l],!(n.indexOf(a)>=0)&&(i[a]=e[a]);return i}var I=g.exports.forwardRef(function(e,n){var i=e.color,r=e.size,a=e.title,l=Te(e,Oe);return s("svg",{ref:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:r,height:r,fill:i,...l,children:[a?t("title",{children:a}):null,t("path",{d:"M1.92.506a.5.5 0 0 1 .434.14L3 1.293l.646-.647a.5.5 0 0 1 .708 0L5 1.293l.646-.647a.5.5 0 0 1 .708 0L7 1.293l.646-.647a.5.5 0 0 1 .708 0L9 1.293l.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .801.13l.5 1A.5.5 0 0 1 15 2v12a.5.5 0 0 1-.053.224l-.5 1a.5.5 0 0 1-.8.13L13 14.707l-.646.647a.5.5 0 0 1-.708 0L11 14.707l-.646.647a.5.5 0 0 1-.708 0L9 14.707l-.646.647a.5.5 0 0 1-.708 0L7 14.707l-.646.647a.5.5 0 0 1-.708 0L5 14.707l-.646.647a.5.5 0 0 1-.708 0L3 14.707l-.646.647a.5.5 0 0 1-.801-.13l-.5-1A.5.5 0 0 1 1 14V2a.5.5 0 0 1 .053-.224l.5-1a.5.5 0 0 1 .367-.27zm.217 1.338L2 2.118v11.764l.137.274.51-.51a.5.5 0 0 1 .707 0l.646.647.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.509.509.137-.274V2.118l-.137-.274-.51.51a.5.5 0 0 1-.707 0L12 1.707l-.646.647a.5.5 0 0 1-.708 0L10 1.707l-.646.647a.5.5 0 0 1-.708 0L8 1.707l-.646.647a.5.5 0 0 1-.708 0L6 1.707l-.646.647a.5.5 0 0 1-.708 0L4 1.707l-.646.647a.5.5 0 0 1-.708 0l-.509-.51z"}),t("path",{d:"M3 4.5a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5zm8-6a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5z"})]})});I.propTypes={color:o.string,size:o.oneOfType([o.string,o.number]),title:o.string};I.defaultProps={color:"currentColor",size:"1em",title:null};var je=I,Le=["color","size","title"];function Se(e,n){if(e==null)return{};var i=Me(e,n),r,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],!(n.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(i[r]=e[r]))}return i}function Me(e,n){if(e==null)return{};var i={},r=Object.keys(e),a,l;for(l=0;l<r.length;l++)a=r[l],!(n.indexOf(a)>=0)&&(i[a]=e[a]);return i}var R=g.exports.forwardRef(function(e,n){var i=e.color,r=e.size,a=e.title,l=Se(e,Le);return s("svg",{ref:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:r,height:r,fill:i,...l,children:[a?t("title",{children:a}):null,t("path",{d:"M13.5 1a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM11 2.5a2.5 2.5 0 1 1 .603 1.628l-6.718 3.12a2.499 2.499 0 0 1 0 1.504l6.718 3.12a2.5 2.5 0 1 1-.488.876l-6.718-3.12a2.5 2.5 0 1 1 0-3.256l6.718-3.12A2.5 2.5 0 0 1 11 2.5zm-8.5 4a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zm11 5.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3z"})]})});R.propTypes={color:o.string,size:o.oneOfType([o.string,o.number]),title:o.string};R.defaultProps={color:"currentColor",size:"1em",title:null};var De=R;function _e(e,n){M(2,arguments);var i=y(e),r=y(n),a=i.getTime()-r.getTime();return a<0?-1:a>0?1:a}function q(e,n){if(e==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}function Ce(e){return q({},e)}var W=1e3*60,N=60*24,K=N*30,Y=N*365;function Ie(e,n,i){var r,a,l;M(2,arguments);var w=ue(),h=(r=(a=i==null?void 0:i.locale)!==null&&a!==void 0?a:w.locale)!==null&&r!==void 0?r:he;if(!h.formatDistance)throw new RangeError("locale must contain localize.formatDistance property");var b=_e(e,n);if(isNaN(b))throw new RangeError("Invalid time value");var c=q(Ce(i),{addSuffix:Boolean(i==null?void 0:i.addSuffix),comparison:b}),v,d;b>0?(v=y(n),d=y(e)):(v=y(e),d=y(n));var x=String((l=i==null?void 0:i.roundingMethod)!==null&&l!==void 0?l:"round"),m;if(x==="floor")m=Math.floor;else if(x==="ceil")m=Math.ceil;else if(x==="round")m=Math.round;else throw new RangeError("roundingMethod must be 'floor', 'ceil' or 'round'");var p=d.getTime()-v.getTime(),f=p/W,z=H(d)-H(v),k=(p-z)/W,O=i==null?void 0:i.unit,u;if(O?u=String(O):f<1?u="second":f<60?u="minute":f<N?u="hour":k<K?u="day":k<Y?u="month":u="year",u==="second"){var G=m(p/1e3);return h.formatDistance("xSeconds",G,c)}else if(u==="minute"){var J=m(f);return h.formatDistance("xMinutes",J,c)}else if(u==="hour"){var Q=m(f/60);return h.formatDistance("xHours",Q,c)}else if(u==="day"){var X=m(k/N);return h.formatDistance("xDays",X,c)}else if(u==="month"){var B=m(k/K);return B===12&&O!=="month"?h.formatDistance("xYears",1,c):h.formatDistance("xMonths",B,c)}else if(u==="year"){var Z=m(k/Y);return h.formatDistance("xYears",Z,c)}throw new RangeError("unit must be 'second', 'minute', 'hour', 'day', 'month' or 'year'")}function Re(e,n){return M(1,arguments),Ie(e,Date.now(),n)}function Be({receipt:e}){const{auth:n}=V().props,[i,r]=g.exports.useState(!0);console.log(n);const{data:a,setData:l,patch:w,processing:h}=ee({id:e.id,repair:e.repair||"",cost:A(e.cost)||"",description:e.description||""}),b=()=>{F.Inertia.reload(),r(d=>!d)},c=d=>{l(d.target.name,d.target.name=="cost"?A(d.target.value.replace(/\D/g,"")):d.target.value)},v=()=>{w(route("receipts"),{preserveScroll:!0,onSuccess:()=>{r(!0)}})};return t("div",{children:t("div",{className:"card bg-base-100 rounded-md shadow-md mt-10 ",children:s("div",{className:"card-body p-4",children:[s("div",{children:[t(E,{children:"Perbaikan"}),t($,{type:"text",name:"repair",value:a.repair,placeHolder:"Perbaikan atau penanganan",disabled:i,handleChange:c})]}),s("div",{children:[t(E,{children:"Biaya"}),t($,{type:"text",name:"cost",value:a.cost,placeHolder:"Biaya perbaikan",disabled:i,handleChange:c})]}),t("h3",{className:"-mb-2 mt-3",children:"Keterangan"}),t("p",{className:"text-sm text-slate-400 italic mb-3",children:"Keterangan tidak bisa diubah jika barang sudah diambil."}),t(oe,{disable:i,name:"description",value:a.description,handleChange:d=>c(d)}),!e.isTaken||n.user.user_type==="admin"?t("div",{className:"mt-3 flex justify-end",children:i?t(L,{className:"w-30 btn-sm",handleClick:b,children:"EDIT"}):s("div",{className:"flex gap-2",children:[t(L,{className:"w-30 btn-sm btn-error",handleClick:b,children:"batal"}),t(L,{className:"w-30 btn-sm btn-success",handleClick:v,processing:h,children:"SIMPAN"})]})}):""]})})})}const Ee=({text:e="Please Wait..."})=>t("div",{className:"top-0 left-0 bottom-0 fixed h-screen w-screen z-20  bg-slate-600/40 backdrop-blur-md flex justify-center items-center text-white font-bold",children:s("h3",{className:"text-lg flex",children:[t(ge,{className:"text-3xl animate-spin mr-2"}),e]})}),$e=()=>{const{receipt:e,processing:n,auth:i}=V().props,r=g.exports.useRef(null),[a,l]=g.exports.useState(!1),[w,h]=g.exports.useState(!1),[b,c]=g.exports.useState(null),v=p=>`${Re(new Date(p),{locale:S})} yang lalu`,d=async()=>{if(!e.customer.whatsapp){P.info("No. whatsapp customer tidak tersedia. Lengkapi data customer.");return}h(!0);const{status:p,data:f}=await ce.post(route("receipts.send",e.id),{whatsapp:e.customer.whatsapp});h(!1),p===200?P.success("E-TTB Berhasil dikirim ke customer"):P.error("E-TTB gagal dikirim ke customer. Coba beberapa saat lagi")},x=()=>{r.current.click()},m=p=>{const f=p.target.files&&p.target.files[0];!f||F.Inertia.post(route("receipts.imageupload",e.id),{photo:f},{preserveState:!0,onBefore:()=>{l(!0)},onProgress:z=>{c(z.percentage)},onSuccess:()=>{c(null),l(!1)}})};return s(te,{children:[w&&t(Ee,{}),s("div",{className:"mt-10 mx-3 relative px-3 lg:mx-64",children:[t(ae,{title:"TTB Detail"}),s("div",{className:"absolute flex flex-col gap-2 right-0 -top-5 z-10",children:[t("button",{className:"btn btn-warning text-2xl btn-circle tooltip tooltip-left pl-[0.7rem] shadow-lg","data-tip":"Cetak Label",onClick:()=>window.open(route("printlabel",e.receipt_code)),children:t(ze,{})}),t("button",{className:"btn btn-success text-2xl btn-circle tooltip tooltip-left pl-[0.7rem] shadow-lg",disabled:w,"data-tip":"Kirim E-TTB",onClick:d,children:t(je,{})}),t("button",{className:"btn btn-error text-2xl btn-circle tooltip tooltip-left pl-[0.7rem] shadow-lg","data-tip":"Kirim link ke whatsapp",onClick:()=>{window.open("https://api.whatsapp.com/send?text="+window.location.href)},children:t(De,{})})]}),t("div",{className:"avatar flex justify-center",children:t("div",{className:"w-1/2 md:w-1/3 lg:w-1/5 rounded-full border-white border-4 shadow-lg",children:t("a",{href:"/"+e.image,target:"_blank",children:t("img",{src:"/"+e.image,alt:e.image})})})}),s("div",{className:"flex justify-center mt-3",children:[t("input",{type:"file",className:"hidden",ref:r,accept:"image/*",onChange:m}),s("button",{className:`btn btn-outline btn-dark shadow-md btn-sm ${a&&"loading"}`,disabled:a,onClick:x,children:[b&&b+"%"," Upload",t(le,{className:"ml-3 text-xl"})]})]}),e.status==="Pending"&&s("div",{className:"alert shadow-md mt-5 flex flex-col",children:[t("h2",{className:"block",children:"Tanda Terima ini belum ditangani"}),t(j,{variant:"primary",data:{id:e.id,status:"proses",handle_by:i.user.name},disable:n,children:"PROSES Sekarang"})]}),!e.isTaken&&e.status!="Pending"&&e.status!="Proses"?s("div",{className:"alert shadow-md mt-5 flex flex-col",children:[t("h2",{className:"block",children:"Ubah status ttb menjadi sudah diambil ?"}),t(ne,{id:e.id})]}):"",e.status==="Proses"&&s("div",{className:"mt-5 flex justify-between items-center alert shadow-md ",children:[t("div",{children:t("h2",{children:"Status Pengerjaan :"})}),s("div",{className:"",children:[t("a",{href:"#modal-gagal",className:"btn btn-sm btn-error shadow-md",children:"gagal"}),t("a",{href:e.cost=="0"||de.exports.isEmpty(e.repair)?"#confirmation":"#modal-sukses",className:"btn btn-sm btn-success shadow-md",children:"Berhasil"}),s(T,{id:"modal-gagal",title:"Perhatian!",message:"Yakin ingin merubah status pengerjaan Batal / Gagal ?",children:[t("a",{href:"#",className:"btn btn-sm",children:"tidak"}),t(j,{className:"block shadow-md",children:"Yakin",data:{id:e.id,status:"gagal"}})]}),t(T,{id:"confirmation",title:"Perhatian!",message:"Keterangan perbaikan atau biaya perbaikan belum diisi...",children:t("a",{href:"#",className:"btn btn-ghost",children:"TUTUP"})}),s(T,{id:"modal-sukses",title:"Perhatian!",message:"Yakin ingin merubah status pengerjaan Sukses / Berhasil ?",children:[t("a",{href:"#",className:"btn btn-sm",children:"tidak"}),t(j,{className:"block shadow-md",children:"Yakin",data:{id:e.id,status:"berhasil"}})]})]})]}),s("div",{className:"mt-8",children:[t("div",{className:"overflow-x-scroll",children:t("table",{className:"table text-left table-zebra table-compact  w-full rounded-lg shadow-md",children:s("tbody",{className:"",children:[s("tr",{children:[t("td",{children:"No Kartu "}),t("td",{children:":"}),s("td",{className:"font-semibold",children:[e.receipt_number," -"," ",s("a",{href:`/images/ttb/ttb_${e.receipt_code}.png`,target:"_blank",className:"tooltip tooltip-bottom text-sky-600","data-tip":"Kartu Tanda Terima Barang",children:["( ",e.receipt_code," )"]})]})]}),s("tr",{children:[t("td",{children:"Tanggal Masuk"}),t("td",{children:":"}),s("td",{children:[U(new Date(e.delivery_date),"dd LLLL yyyy",{locale:S})," ",t("br",{})," ",s("span",{className:"italic text-slate-500",children:["( ",v(e.delivery_date)," ",")"]})]})]}),e.isTaken&&s("tr",{children:[t("td",{children:"Tanggal Ambil"}),t("td",{children:":"}),s("td",{children:[U(new Date(e.pickup_date),"dd LLLL yyyy",{locale:S}),t("br",{}),s("span",{className:"italic text-slate-500",children:["("," ",v(e.pickup_date)," ",")"]})]})]}),s("tr",{children:[t("td",{children:"Customer"}),t("td",{children:":"}),t("td",{className:"hover:bg-blue-300",children:s(re,{href:route("customer.show",e.customer.id),className:"flex items-center gap-2 tooltip tooltip-bottom","data-tip":"Detail Customer",children:[e.customer.name,t(ye,{})]})})]}),s("tr",{children:[t("td",{children:"Penerima"}),t("td",{children:":"}),t("td",{className:"capitalize",children:e.user.name})]}),e.handle_by!=""&&s("tr",{children:[t("td",{children:"Teknisi"}),t("td",{children:":"}),t("td",{children:e.handle_by})]}),s("tr",{children:[t("td",{children:"Barang"}),t("td",{children:":"}),t("td",{children:s("p",{className:"capitalize",children:[e.category," -"," ",e.barang]})})]}),s("tr",{children:[t("td",{children:"Kelengkapan"}),t("td",{children:":"}),t("td",{children:e.kelengkapan?e.kelengkapan.join(" | "):"Tidak ada"})]}),s("tr",{children:[t("td",{children:"Kerusakan"}),t("td",{children:":"}),t("td",{children:e.kerusakan})]}),s("tr",{children:[t("td",{children:"Status "}),t("td",{children:":"}),t("td",{children:s("div",{className:"flex gap-2",children:[t(se,{status:e.status,className:"rounded-full px-3 py-1 dark:text-slate-700"}),e.isTaken&&t("div",{className:"rounded-full px-3 py-1 bg-success dark:text-slate-700",children:"Sudah Diambil"})]})})]})]})})}),t(Be,{receipt:e})]})]})]})};$e.layout=e=>t(ie,{auth:e.props.auth,children:e,menu:!1,href:route("receipts")});export{$e as default};
