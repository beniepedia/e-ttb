import{a as e,L as N,j as r,F as f,b as x,r as c,d as v,H as _,e as S,t as T,s as w}from"./app.b635f412.js";import{I as P}from"./Input.5fea4b36.js";import{L as E}from"./Loading.c995c7a0.js";import{B}from"./Button.5b4779fb.js";import{T as I,B as L}from"./TransactionDetail.63732261.js";import{c as C}from"./Helper.519f33e1.js";import{f as p,i as D}from"./index.19391a32.js";import{G as M}from"./Guest.7a588bd6.js";import"./index.173378b6.js";import"./whatsapp.23ed22f3.js";const A=({...n})=>e("div",{className:" mt-5",children:e(N,{href:route("payment",n.receipt_code),preserveState:!0,className:"w-full",children:e(B,{className:"btn-secondary dark:btn-success w-full",children:"Bayar Sekarang"})})}),H=({showImage:n=!0,...a})=>{const t=a,s=t.image.substring(t.image.lastIndexOf("/")+1,t.image.lastIndexOf("."));return r(f,{children:[e("div",{className:"overflow-x-auto",children:e("table",{className:"table table-compact w-full dark:text-slate-400",children:r("tbody",{children:[r("tr",{children:[e("th",{children:"No. Register"}),e("th",{children:":"}),e("td",{children:t.receipt_code})]}),r("tr",{children:[e("th",{children:"No. Kartu"}),e("th",{children:":"}),e("td",{children:t.receipt_number})]}),r("tr",{children:[e("th",{children:"Customer"}),e("th",{children:":"}),e("td",{children:t.customer.name})]}),r("tr",{children:[e("th",{children:"Tgl Masuk"}),e("th",{children:":"}),e("td",{children:p(new Date(t.delivery_date),"EEEE, dd MMMM yyyy",{locale:D})})]}),r("tr",{children:[e("th",{children:"Jam"}),e("th",{children:":"}),e("td",{children:p(new Date(t.delivery_date),"HH:mm")})]}),r("tr",{children:[e("th",{children:"Jenis & Type"}),e("th",{children:":"}),r("td",{className:"capitalize",children:[t.category," - ",t.barang]})]}),r("tr",{children:[e("th",{children:"Kerusakan"}),e("th",{children:":"}),e("td",{children:t.kerusakan})]}),r("tr",{children:[e("th",{children:"Kelengkapan"}),e("th",{children:":"}),e("td",{children:t.kelengkapan?t.kelengkapan.join(" | "):"-"})]}),r("tr",{children:[e("th",{children:"Status"}),e("th",{children:":"}),e("td",{children:t.status})]}),r("tr",{children:[e("th",{children:"Perbaikan"}),e("th",{children:":"}),e("td",{children:t.repair})]}),r("tr",{children:[e("th",{children:"Biaya"}),e("th",{children:":"}),e("td",{children:t.cost==0?"-":C(t.cost)})]})]})})}),n&&e("div",{className:`mt-3 ${s=="no_image"?"hidden":"block"}`,children:e("img",{src:`/${t.image}`,className:"rounded-md",alt:"..."})})]})},F=()=>new Promise((n,a)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(({coords:t})=>{n(t)},t=>{a(t)},{enableHighAccuracy:!0}):a(new Error("Geolocation is not supported in this browser."))}),V=()=>{var u;const{filters:n,receipt:a,can_pay:t,app_setting:s}=x().props,[g,o]=c.exports.useState(!1),[b,h]=c.exports.useState({latitude:"",longitude:""}),[k,y]=c.exports.useState(!1),[d,m]=c.exports.useState({receipt_code:n.receipt_code||""});return c.exports.useEffect(()=>{F().then(({latitude:i,longitude:l})=>{h({latitude:i,longitude:l})}).catch(i=>{h({latitude:"",longitude:""})})},[]),c.exports.useEffect(()=>{v().then(i=>{i=="granted"&&y(!0)})},[]),r(f,{children:[g&&e(E,{text:"Silahkan tunggu..."}),e(_,{children:e("title",{children:"Cek Status Tanda Terima"})}),e(M,{children:r("div",{className:"text-slate-700 dark:text-slate-500 mb-10",children:[e("h1",{className:"font-semibold text-center text-xl uppercase mb-10",children:"Cek status tanda terima"}),r("div",{className:"my-3",children:[r("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),S.Inertia.get(route(route().current()),{receipt_code:d.receipt_code},{headers:{location:JSON.stringify(b)},preserveState:!0,replace:!0,onBefore:()=>{o(!0)},onSuccess:({props:l})=>{l.receipt||(T.error(`Tanda terima dengan nomor register ${d.receipt_code} tidak ditemukan!. Silahkan coba lagi`),m({receipt_code:""})),k&&w()},onFinish:()=>{o(!1)}})},children:[e(P,{type:"search",value:d.receipt_code,handleChange:i=>m({receipt_code:i.target.value}),placeHolder:"Masukkan nomor \r register",className:"text-sm"}),e("button",{disabled:d.receipt_code=="",className:"mt-3 w-full btn rounded  btn-accent dark:btn-success",type:"submit",children:"cek Tanda Terima"})]}),r("div",{className:`${a?"block":"hidden"} my-7`,children:[e("div",{className:"divider mb-7 font-semibold",children:"DETAIL TANDA TERIMA"}),r("div",{className:"mb-4",children:[a&&e(H,{...a}),(s==null?void 0:s.pay_online)&&t&&a&&e(A,{...a})]}),((u=a==null?void 0:a.transaction)==null?void 0:u.transaction_status)=="PAID"&&e(I,{}),e(L,{})]})]})]})})]})};export{V as default};
