import{b as j,r as t,a as s,j as h,F}from"./app.c68b0d05.js";import{M}from"./Main.271e94e5.js";import{a as u}from"./index.5220e4e6.js";import{B as v}from"./Button.96f909cc.js";import"./axios.40b98a77.js";const q=()=>{const{session:o}=j().props;let A="images/assets/fail.png",I="images/assets/success.png",S="images/assets/loader.gif";const[E,n]=t.exports.useState("TIDAK ADA SESI"),[y,d]=t.exports.useState(!1),[p,r]=t.exports.useState(!1),[x,l]=t.exports.useState(S),[a,g]=t.exports.useState(o),[f,c]=t.exports.useState(!1);t.exports.useEffect(()=>{!a==""&&k()},[]),t.exports.useEffect(()=>{if(f){let e=setInterval(()=>{D()},5e3);return()=>clearInterval(e)}},[f]);const D=()=>{u.post(route("whatsapp.status"),{sessname:a}).then(({data:e})=>{let i=e.data;e.success?i.status=="authenticated"&&b():(g(""),m(),N())})},k=()=>{u.post(route("whatsapp.find"),{sessname:a}).then(({data:e})=>{e.success?b():m()}).catch(e=>{w()})},b=()=>{l(I),n("TERHUBUNG"),d(!0),c(!1)},w=()=>{l(A),n("SERVER DOWN"),d(!1),c(!1)},m=()=>{l(S),n("TIDAK ADA SESI"),d(!1),c(!1)},N=()=>{r(!0),u.post(route("whatsapp.delete"),{sessname:a}).then(({data:e})=>{console.log(e),e.success&&m(),r(!1)})};return s("form",{onSubmit:e=>{e.preventDefault(),r(!0),u.post(route("whatsapp.addsession"),{sessname:a}).then(i=>{let C=i.data.success,U=i.data.data.qr;C?(l(U),n("SCAN ME"),r(!1),c(!0)):w()})},children:s("div",{className:"my-8 flex justify-center mx-20 md:mx-10",children:h("div",{className:"flex gap-2 flex-col w-full md:w-1/3",children:[h("div",{className:" rounded-lg shadow overflow-hidden",children:[s("img",{src:x,alt:x,className:"border-white bg-slate-100 border-8 w-full"}),s("div",{className:"bg-sky-300 py-4 text-center",children:s("h1",{className:"font-semibold text-xl text-slate-700",children:E})})]}),!f&&(y?s(v,{type:"button",className:"btn-error",processing:p,handleClick:N,children:"HAPUS SESI"}):h(F,{children:[s("input",{value:a,type:"text",className:"input input-bordered mt-8",onChange:e=>g(e.target.value),placeholder:"Masukkan nama sesi"}),s(v,{type:"submit",processing:p,children:p?"please wait":"tambah sesi"})]}))]})})})};q.layout=o=>s(M,{auth:o.props.auth,children:o});export{q as default};
