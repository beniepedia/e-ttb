import{r as g,j as s,a as t,u as X,d as K,b as Z,F as ee,H as te,L as ae}from"./app.f186c1de.js";import{P as o,j as O,M as re,t as T}from"./Main.c8e75258.js";import{C as ie,B as L,a as le,S as ne}from"./ButtonIsTaken.d5d817ca.js";import{T as se}from"./TextArea.901351b7.js";import{B as P}from"./Button.10b38872.js";import{L as C}from"./Label.7e27d19c.js";import{I as B}from"./Input.fc99a443.js";import{c as E}from"./Helper.d9e24006.js";import{l as oe}from"./lodash.40118fbd.js";import{a as de}from"./index.5220e4e6.js";import{d as ce,g as A,a as he,f as $}from"./index.dbcb883f.js";import{r as S,t as w,i as j}from"./index.7f05af33.js";import"./axios.40b98a77.js";var ue=["color","size","title"];function me(e,n){if(e==null)return{};var i=fe(e,n),r,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],!(n.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(i[r]=e[r]))}return i}function fe(e,n){if(e==null)return{};var i={},r=Object.keys(e),a,l;for(l=0;l<r.length;l++)a=r[l],!(n.indexOf(a)>=0)&&(i[a]=e[a]);return i}var M=g.exports.forwardRef(function(e,n){var i=e.color,r=e.size,a=e.title,l=me(e,ue);return s("svg",{ref:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:r,height:r,fill:i,...l,children:[a?t("title",{children:a}):null,t("path",{d:"M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"}),t("path",{fillRule:"evenodd",d:"M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"})]})});M.propTypes={color:o.string,size:o.oneOfType([o.string,o.number]),title:o.string};M.defaultProps={color:"currentColor",size:"1em",title:null};var pe=M,ge=["color","size","title"];function be(e,n){if(e==null)return{};var i=ve(e,n),r,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],!(n.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(i[r]=e[r]))}return i}function ve(e,n){if(e==null)return{};var i={},r=Object.keys(e),a,l;for(l=0;l<r.length;l++)a=r[l],!(n.indexOf(a)>=0)&&(i[a]=e[a]);return i}var D=g.exports.forwardRef(function(e,n){var i=e.color,r=e.size,a=e.title,l=be(e,ge);return s("svg",{ref:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:r,height:r,fill:i,...l,children:[a?t("title",{children:a}):null,t("path",{fillRule:"evenodd",d:"M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"})]})});D.propTypes={color:o.string,size:o.oneOfType([o.string,o.number]),title:o.string};D.defaultProps={color:"currentColor",size:"1em",title:null};var we=D,ye=["color","size","title"];function xe(e,n){if(e==null)return{};var i=ke(e,n),r,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],!(n.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(i[r]=e[r]))}return i}function ke(e,n){if(e==null)return{};var i={},r=Object.keys(e),a,l;for(l=0;l<r.length;l++)a=r[l],!(n.indexOf(a)>=0)&&(i[a]=e[a]);return i}var _=g.exports.forwardRef(function(e,n){var i=e.color,r=e.size,a=e.title,l=xe(e,ye);return s("svg",{ref:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:r,height:r,fill:i,...l,children:[a?t("title",{children:a}):null,t("path",{d:"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z"}),t("path",{d:"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z"})]})});_.propTypes={color:o.string,size:o.oneOfType([o.string,o.number]),title:o.string};_.defaultProps={color:"currentColor",size:"1em",title:null};var Ne=_,ze=["color","size","title"];function Oe(e,n){if(e==null)return{};var i=Te(e,n),r,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],!(n.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(i[r]=e[r]))}return i}function Te(e,n){if(e==null)return{};var i={},r=Object.keys(e),a,l;for(l=0;l<r.length;l++)a=r[l],!(n.indexOf(a)>=0)&&(i[a]=e[a]);return i}var I=g.exports.forwardRef(function(e,n){var i=e.color,r=e.size,a=e.title,l=Oe(e,ze);return s("svg",{ref:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:r,height:r,fill:i,...l,children:[a?t("title",{children:a}):null,t("path",{d:"M1.92.506a.5.5 0 0 1 .434.14L3 1.293l.646-.647a.5.5 0 0 1 .708 0L5 1.293l.646-.647a.5.5 0 0 1 .708 0L7 1.293l.646-.647a.5.5 0 0 1 .708 0L9 1.293l.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .801.13l.5 1A.5.5 0 0 1 15 2v12a.5.5 0 0 1-.053.224l-.5 1a.5.5 0 0 1-.8.13L13 14.707l-.646.647a.5.5 0 0 1-.708 0L11 14.707l-.646.647a.5.5 0 0 1-.708 0L9 14.707l-.646.647a.5.5 0 0 1-.708 0L7 14.707l-.646.647a.5.5 0 0 1-.708 0L5 14.707l-.646.647a.5.5 0 0 1-.708 0L3 14.707l-.646.647a.5.5 0 0 1-.801-.13l-.5-1A.5.5 0 0 1 1 14V2a.5.5 0 0 1 .053-.224l.5-1a.5.5 0 0 1 .367-.27zm.217 1.338L2 2.118v11.764l.137.274.51-.51a.5.5 0 0 1 .707 0l.646.647.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.509.509.137-.274V2.118l-.137-.274-.51.51a.5.5 0 0 1-.707 0L12 1.707l-.646.647a.5.5 0 0 1-.708 0L10 1.707l-.646.647a.5.5 0 0 1-.708 0L8 1.707l-.646.647a.5.5 0 0 1-.708 0L6 1.707l-.646.647a.5.5 0 0 1-.708 0L4 1.707l-.646.647a.5.5 0 0 1-.708 0l-.509-.51z"}),t("path",{d:"M3 4.5a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5zm8-6a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5z"})]})});I.propTypes={color:o.string,size:o.oneOfType([o.string,o.number]),title:o.string};I.defaultProps={color:"currentColor",size:"1em",title:null};var Le=I;function Pe(e,n){S(2,arguments);var i=w(e),r=w(n),a=i.getTime()-r.getTime();return a<0?-1:a>0?1:a}function Y(e,n){if(e==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}function je(e){return Y({},e)}var H=1e3*60,k=60*24,U=k*30,W=k*365;function Se(e,n,i){var r,a,l;S(2,arguments);var b=he(),c=(r=(a=i==null?void 0:i.locale)!==null&&a!==void 0?a:b.locale)!==null&&r!==void 0?r:ce;if(!c.formatDistance)throw new RangeError("locale must contain localize.formatDistance property");var f=Pe(e,n);if(isNaN(f))throw new RangeError("Invalid time value");var m=Y(je(i),{addSuffix:Boolean(i==null?void 0:i.addSuffix),comparison:f}),d,v;f>0?(d=w(n),v=w(e)):(d=w(e),v=w(n));var p=String((l=i==null?void 0:i.roundingMethod)!==null&&l!==void 0?l:"round"),h;if(p==="floor")h=Math.floor;else if(p==="ceil")h=Math.ceil;else if(p==="round")h=Math.round;else throw new RangeError("roundingMethod must be 'floor', 'ceil' or 'round'");var N=v.getTime()-d.getTime(),y=N/H,V=A(v)-A(d),x=(N-V)/H,z=i==null?void 0:i.unit,u;if(z?u=String(z):y<1?u="second":y<60?u="minute":y<k?u="hour":x<U?u="day":x<W?u="month":u="year",u==="second"){var F=h(N/1e3);return c.formatDistance("xSeconds",F,m)}else if(u==="minute"){var q=h(y);return c.formatDistance("xMinutes",q,m)}else if(u==="hour"){var G=h(y/60);return c.formatDistance("xHours",G,m)}else if(u==="day"){var J=h(x/k);return c.formatDistance("xDays",J,m)}else if(u==="month"){var R=h(x/U);return R===12&&z!=="month"?c.formatDistance("xYears",1,m):c.formatDistance("xMonths",R,m)}else if(u==="year"){var Q=h(x/W);return c.formatDistance("xYears",Q,m)}throw new RangeError("unit must be 'second', 'minute', 'hour', 'day', 'month' or 'year'")}function Me(e,n){return S(1,arguments),Se(e,Date.now(),n)}function De({receipt:e}){const[n,i]=g.exports.useState(!0),{data:r,setData:a,patch:l,processing:b}=X({id:e.id,repair:e.repair||"",cost:E(e.cost)||"",description:e.description||""}),c=()=>{K.Inertia.reload(),i(d=>!d)},f=d=>{a(d.target.name,d.target.name=="cost"?E(d.target.value.replace(/\D/g,"")):d.target.value)},m=()=>{l(route("receipts"),{preserveScroll:!0,onSuccess:()=>{i(!0)}})};return t("div",{children:t("div",{className:"card bg-base-100 rounded-md shadow-md mt-10 ",children:s("div",{className:"card-body p-4",children:[s("div",{children:[t(C,{children:"Perbaikan"}),t(B,{type:"text",name:"repair",value:r.repair,placeHolder:"Perbaikan atau penanganan",disabled:n,handleChange:f})]}),s("div",{children:[t(C,{children:"Biaya"}),t(B,{type:"text",name:"cost",value:r.cost,placeHolder:"Biaya perbaikan",disabled:n,handleChange:f})]}),t("h3",{className:"-mb-2 mt-3",children:"Keterangan"}),t("p",{className:"text-sm text-slate-400 italic mb-3",children:"Keterangan tidak bisa diubah jika barang sudah diambil."}),t(se,{disable:n,name:"description",value:r.description,handleChange:d=>f(d)}),!e.isTaken&&t("div",{className:"mt-3 flex justify-end",children:n?t(P,{className:"w-30 btn-sm",handleClick:c,children:"EDIT"}):s("div",{className:"flex gap-2",children:[t(P,{className:"w-30 btn-sm btn-error",handleClick:c,children:"batal"}),t(P,{className:"w-30 btn-sm btn-success",handleClick:m,processing:b,children:"SIMPAN"})]})})]})})})}const _e=({text:e="Please Wait..."})=>t("div",{className:"top-0 left-0 bottom-0 fixed h-screen w-screen z-20  bg-slate-600/40 backdrop-blur-md flex justify-center items-center text-white font-bold",children:s("h3",{className:"text-lg flex",children:[t(pe,{className:"text-3xl animate-spin mr-2"}),e]})}),Ie=()=>{const{receipt:e,processing:n,auth:i}=Z().props,r=g.exports.useRef(null),[a,l]=g.exports.useState(!1),[b,c]=g.exports.useState(!1),f=p=>`${Me(new Date(p),{locale:j})} yang lalu`,m=async()=>{if(!e.customer.whatsapp){T.info("No. whatsapp customer tidak tersedia. Lengkapi data customer.");return}c(!0);const{status:p,data:h}=await de.post(route("receipts.send",e.id),{whatsapp:e.customer.whatsapp});c(!1),p===200?T.success("E-TTB Berhasil dikirim ke customer"):T.error("E-TTB gagal dikirim ke customer. Coba beberapa saat lagi")},d=()=>{r.current.click()},v=p=>{const h=p.target.files&&p.target.files[0];!h||K.Inertia.post(route("receipts.imageupload",e.id),{photo:h},{preserveState:!0,onBefore:()=>{l(!0)},onSuccess:()=>{l(!1)}})};return s(ee,{children:[b&&t(_e,{}),s("div",{className:"mt-10 mx-3 relative",children:[t(te,{title:"TTB Detail"}),s("div",{className:"absolute flex flex-row gap-2 right-0 -top-5 z-10",children:[t("button",{className:"btn btn-warning text-2xl btn-circle tooltip tooltip-bottom pl-[0.7rem] shadow-lg","data-tip":"Cetak Label",onClick:()=>window.open(route("printlabel",e.receipt_code)),children:t(Ne,{})}),t("button",{className:"btn btn-success text-2xl btn-circle tooltip tooltip-left pl-[0.7rem] shadow-lg",disabled:b,"data-tip":"Kirim E-TTB",onClick:m,children:t(Le,{})})]}),t("div",{className:"avatar flex justify-center",children:t("div",{className:"w-1/2 md:w-1/3 lg:w-1/5 rounded-full border-white border-4 shadow-lg",children:t("a",{href:"/"+e.image,target:"_blank",children:t("img",{src:"/"+e.image,alt:e.image})})})}),s("div",{className:"flex justify-center mt-3",children:[t("input",{type:"file",className:"hidden",ref:r,accept:"image/*",onChange:v}),s("button",{className:`btn btn-outline btn-dark shadow-md btn-sm ${a&&"loading"}`,disabled:a,onClick:d,children:["Upload",t(ie,{className:"ml-3 text-xl"})]})]}),e.status==="Pending"&&s("div",{className:"alert shadow-md mt-5 flex flex-col",children:[t("h2",{className:"block",children:"Tanda Terima ini belum ditangani"}),t(L,{variant:"primary",data:{id:e.id,status:"proses",handle_by:i.user.name},disable:n,children:"PROSES Sekarang"})]}),!e.isTaken&&e.status!="Pending"&&e.status!="Proses"?s("div",{className:"alert shadow-md mt-5 flex flex-col",children:[t("h2",{className:"block",children:"Ubah status ttb menjadi sudah diambil ?"}),t(le,{id:e.id})]}):"",e.status==="Proses"&&s("div",{className:"mt-5 flex justify-between items-center alert shadow-md ",children:[t("div",{children:t("h2",{children:"Status Pengerjaan :"})}),s("div",{className:"",children:[t("a",{href:"#modal-gagal",className:"btn btn-sm btn-error shadow-md",children:"gagal"}),t("a",{href:e.cost=="0"||oe.exports.isEmpty(e.repair)?"#confirmation":"#modal-sukses",className:"btn btn-sm btn-success shadow-md",children:"Berhasil"}),s(O,{id:"modal-gagal",title:"Perhatian!",message:"Yakin ingin merubah status pengerjaan Batal / Gagal ?",children:[t("a",{href:"#",className:"btn btn-sm",children:"tidak"}),t(L,{className:"block shadow-md",children:"Yakin",data:{id:e.id,status:"gagal"}})]}),t(O,{id:"confirmation",title:"Perhatian!",message:"Keterangan perbaikan atau biaya perbaikan belum diisi...",children:t("a",{href:"#",className:"btn btn-ghost",children:"TUTUP"})}),s(O,{id:"modal-sukses",title:"Perhatian!",message:"Yakin ingin merubah status pengerjaan Sukses / Berhasil ?",children:[t("a",{href:"#",className:"btn btn-sm",children:"tidak"}),t(L,{className:"block shadow-md",children:"Yakin",data:{id:e.id,status:"berhasil"}})]})]})]}),s("div",{className:"mt-8",children:[t("div",{className:"overflow-x-scroll",children:t("table",{className:"table text-left table-zebra table-compact  w-full rounded-lg shadow-md",children:s("tbody",{className:"",children:[s("tr",{children:[t("td",{children:"No Kartu "}),t("td",{children:":"}),s("td",{className:"font-semibold",children:[e.receipt_number," -"," ",s("a",{href:`/images/ttb/ttb_${e.receipt_code}.png`,target:"_blank",className:"tooltip tooltip-bottom text-sky-600","data-tip":"Kartu Tanda Terima Barang",children:["( ",e.receipt_code," )"]})]})]}),s("tr",{children:[t("td",{children:"Tanggal Masuk"}),t("td",{children:":"}),s("td",{children:[$(new Date(e.delivery_date),"dd LLLL yyyy",{locale:j})," ",t("br",{})," ",s("span",{className:"italic text-slate-500",children:["( ",f(e.delivery_date)," ",")"]})]})]}),e.isTaken&&s("tr",{children:[t("td",{children:"Tanggal Ambil"}),t("td",{children:":"}),s("td",{children:[$(new Date(e.pickup_date),"dd LLLL yyyy",{locale:j}),t("br",{}),s("span",{className:"italic text-slate-500",children:["("," ",f(e.pickup_date)," ",")"]})]})]}),s("tr",{children:[t("td",{children:"Customer"}),t("td",{children:":"}),t("td",{className:"hover:bg-blue-300",children:s(ae,{href:route("customer.show",e.customer.id),className:"flex items-center gap-2 tooltip tooltip-bottom","data-tip":"Detail Customer",children:[e.customer.name,t(we,{})]})})]}),s("tr",{children:[t("td",{children:"Penerima"}),t("td",{children:":"}),t("td",{className:"capitalize",children:e.user.name})]}),e.status!="Pending"||e.handle_by!=""&&s("tr",{children:[t("td",{children:"Teknisi"}),t("td",{children:":"}),t("td",{children:e.handle_by})]}),s("tr",{children:[t("td",{children:"Barang"}),t("td",{children:":"}),t("td",{children:s("p",{className:"capitalize",children:[e.category," -"," ",e.barang]})})]}),s("tr",{children:[t("td",{children:"Kelengkapan"}),t("td",{children:":"}),t("td",{children:e.kelengkapan?e.kelengkapan.join(" | "):"Tidak ada"})]}),s("tr",{children:[t("td",{children:"Kerusakan"}),t("td",{children:":"}),t("td",{children:e.kerusakan})]}),s("tr",{children:[t("td",{children:"Status "}),t("td",{children:":"}),t("td",{children:s("div",{className:"flex gap-2",children:[t(ne,{status:e.status,className:"rounded-full px-3 py-1"}),e.isTaken&&t("div",{className:"rounded-full px-3 py-1 bg-success",children:"Sudah Diambil"})]})})]})]})})}),t(De,{receipt:e})]})]})]})};Ie.layout=e=>t(re,{auth:e.props.auth,children:e,menu:!1,href:route("receipts")});export{Ie as default};
