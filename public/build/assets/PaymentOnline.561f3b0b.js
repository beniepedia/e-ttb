import{b as y,j as c,F as N,a as e,r as k,u as D,H as M}from"./app.34fd5e13.js";import{B as _}from"./Button.94c089fe.js";import{I as x}from"./Input.0ce51470.js";import{T as w}from"./TextArea.9bb849a8.js";import{D as A,T as B,B as E}from"./TransactionDetail.2d06a6f7.js";import{a as I}from"./index.9466a457.js";import{M as C}from"./Modal.4a99274c.js";import{L as T}from"./Loading.c0c07ca7.js";import{G as F}from"./Guest.b7528aeb.js";import"./index.173378b6.js";import"./whatsapp.b4181eaf.js";import"./Helper.56f1d425.js";const L=({...t})=>{var l;const{payment_channel:d}=y().props,n=t.data,a=t.errors;return c(N,{children:[e("div",{className:"divider font-semibold mt-5",children:"METODE PEMBAYARAN"}),c("div",{className:"space-y-2",children:[(l=d==null?void 0:d.data)==null?void 0:l.map((m,i)=>c(_,{className:`flex items-center gap-4 w-full shadow  justify-start hover:bg-sky-400 dark:hover:bg-emerald-800 ${n.payment_method==m.code?"bg-sky-400 dark:bg-emerald-800 dark:text-emerald-100":"bg-white text-slate-800 dark:text-slate-400 dark:bg-slate-700"}`,handleClick:()=>t.setData({...n,payment_method:m.code}),children:[e("img",{src:m.icon_url,width:60}),e("p",{children:m.name})]},i)),(a==null?void 0:a.payment_method)&&e("div",{className:"text-red-600 mt-2",children:a==null?void 0:a.payment_method})]})]})},R=({data:t,setData:d})=>{const{receipt:n}=y().props,[a,l]=k.exports.useState(""),[m,i]=k.exports.useState(""),[u,o]=k.exports.useState(""),[v,r]=k.exports.useState(!1),P=()=>{i(""),r(!0),o(""),I.post(route("transaction.promo"),{promo_code:a,receipt_id:n.id}).then(s=>{var h,b,f;const g=(h=s==null?void 0:s.data)==null?void 0:h.message,p=(f=(b=s==null?void 0:s.data)==null?void 0:b.value)!=null?f:0;o(g),d({...t,discount:p,amount_total:t.amount-p})}).catch(s=>{var h,b,f;const g=(b=(h=s==null?void 0:s.response)==null?void 0:h.data)==null?void 0:b.message,p=(f=s==null?void 0:s.response)==null?void 0:f.status;p==422&&i(g),p==404&&i(g)}).finally(()=>r(!1))};return c(N,{children:[e(A,{children:"PROMO"}),c("div",{className:"",children:[c("div",{className:"grid grid-cols-3",children:[e("div",{className:"col-span-2",children:e(x,{placeHolder:"Masukkan kode promo",className:"rounded-r-none",value:a,handleChange:s=>l(s.target.value)})}),e(_,{className:"rounded-l-none dark:btn-success",type:"button",handleClick:()=>P(),processing:v,children:"terapkan"})]}),m&&e("div",{className:"text-red-600 mt-1 ",children:m}),u&&e("div",{className:"text-green-900 mt-1 ",children:u})]})]})},j=({onHandleChange:t,onPress:d,data:n,errors:a,loading:l,setData:m})=>{const i=k.exports.useRef(),u=()=>{i.current.click(),d()};return c(N,{children:[e(A,{className:"mt-7",children:"INFO PEMBAYARAN"}),e("div",{className:"text-sm text-center",children:"Lengkapi formulir dibawah sebelum melanjutkan ke proses pembayaran."}),c("div",{className:"mt-3 ",children:[e(x,{handleChange:o=>t(o),value:n.full_name,name:"full_name",className:`text-sm ${(a==null?void 0:a.full_name)&&"input-error"}`,placeHolder:"Masukkan nama lengkap"}),e("div",{className:"invalid-feedback mb-2",children:a==null?void 0:a.full_name}),e(x,{handleChange:o=>t(o),name:"email",value:n.email,className:`text-sm mt-2 ${(a==null?void 0:a.email)&&"input-error"}`,placeHolder:"Masukkan email aktif"}),e("div",{className:"invalid-feedback mb-2",children:a==null?void 0:a.email}),e(w,{name:"address",value:n.address,handleChange:o=>t(o),placeHolder:"Alamat lengkap",className:`mt-2 -mb-1 ${(a==null?void 0:a.address)&&"input-error"}`}),e("div",{className:"invalid-feedback mb-2",children:a==null?void 0:a.address}),e(R,{data:n,setData:m}),c("a",{disabled:l,href:"#pembayaran",className:"btn w-full mt-4 btn-accent dark:btn-primary rounded shadow",children:["Bayar ( Rp."," ",new Intl.NumberFormat({locale:"id_ID"}).format(n.amount_total)," ",")"]})]}),l&&e(T,{text:"Tunggu sebentar..."}),c(C,{title:"Pembayaran!",message:"Pastikan data pembayaran sudah benar. Yakin ingin melanjutkan pembayaran ?",id:"pembayaran",children:[e("a",{ref:i,href:"#",className:"btn rounded btn-sm md:btn-md btn-error text-white",children:"BATAL"}),e(_,{className:"btn-sm md:btn-md",handleClick:()=>u(),processing:l,children:"IYA, LANJUTKAN"})]})]})},Q=()=>{const{receipt:t}=y().props,d=t.customer,n=t==null?void 0:t.transaction,{data:a,setData:l,errors:m,processing:i,post:u}=D({full_name:d.full_name,email:d.email,address:d.address,receipt_id:t.id,phone:t.customer.phone,payment_method:"",amount:t.cost,amount_total:t.cost,discount:0}),o=r=>{l({...a,[r.target.name]:r.target.value})},v=()=>{u(route("transaction.gettoken"),{preserveScroll:!0})};return c(F,{children:[e(M,{children:e("title",{children:"Pembayaran"})}),e("div",{className:"text-slate-700 dark:text-slate-400 mb-10",children:e("h1",{className:"font-semibold text-center text-xl uppercase mb-10",children:"PEMBAYARAN"})}),n&&e(B,{}),!n||n.transaction_status=="EXPIRED"||n.transaction_status=="FAILED"?c(N,{children:[e(L,{data:a,setData:l,errors:m}),e(j,{onHandleChange:o,data:a,setData:l,errors:m,onPress:v,loading:i})]}):"",e(E,{})]})};export{Q as default};
